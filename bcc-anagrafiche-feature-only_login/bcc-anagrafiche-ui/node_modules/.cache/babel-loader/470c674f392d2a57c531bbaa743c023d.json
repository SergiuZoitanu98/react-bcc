{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\Gigabyte\\\\Desktop\\\\react-bcc\\\\react-bcc\\\\bcc-anagrafiche-feature-only_login\\\\bcc-anagrafiche-ui\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\Gigabyte\\\\Desktop\\\\react-bcc\\\\react-bcc\\\\bcc-anagrafiche-feature-only_login\\\\bcc-anagrafiche-ui\\\\src\\\\App.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from 'react';\nimport './App.css';\nimport { withRouter, Route, Switch } from \"react-router-dom\";\nimport { Login } from \"./anagrafica_components/Login\";\nimport { RicercaClienti } from \"./anagrafica_components/RicercaClienti\";\nimport { SuccessEdit } from \"./anagrafica_components/SuccessEdit\";\nimport { USER_TYPE, ROUTES } from \"./anagrafica_components/common/Constants\";\nimport axios from \"axios\";\nimport config from \"./config.json\";\nimport dotenv from \"dotenv\";\ndotenv.config();\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      userType: null,\n      username: \"\"\n    };\n\n    this.handleLogin = loginRequest => {\n      const headers = {\n        \"Content-Type\": \"application/json\"\n      };\n      const conf = {\n        headers: _objectSpread({}, headers)\n      };\n      let roles = [];\n      axios.post(config.apiLoginEndpoint, loginRequest, conf).then(response => {\n        roles = [...response.data.roles]; //saving token and username in local storage to persist data for the session\n\n        localStorage.setItem(\"TOKEN\", response.data.accessToken);\n        localStorage.setItem(\"USERNAME\", response.data.username);\n        this.setState({\n          roles: roles,\n          username: response.data.username,\n          userType: roles.length === 1 && roles[0].authority === USER_TYPE.USER ? USER_TYPE.USER : USER_TYPE.ADMINISTRATOR\n        }); //checking if the user logged is a simple user or an admin\n\n        if (roles.length === 1 && roles[0].authority === USER_TYPE.USER) {\n          this.props.history.replace(window.defConfigurations.url_prefix + ROUTES.RICERCA_CLIENTI);\n        } else {\n          this.props.history.replace(window.defConfigurations.url_prefix + ROUTES.IMPORTA_CLIENTI);\n        }\n      }).catch(err => console.log(err.response));\n    };\n  }\n\n  UNSAFE_componentWillMount() {\n    //this if handle an eventual modification of URL from the user and redirect it to the login\n    if (this.props.location.pathname === \"/\" || this.props.location.pathname === \"\" || this.props.location.pathname === window.defConfigurations.url_prefix) {\n      localStorage.removeItem(\"TOKEN\");\n      this.props.history.replace(window.defConfigurations.url_prefix + ROUTES.LOGIN);\n    }\n\n    for (let api in config) {\n      config[api] = config[api].replace(\"[REACT_APP_URL_JAVA]\", window.defConfigurations.REACT_APP_URL_JAVA);\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(Route, {\n      path: window.defConfigurations.url_prefix + ROUTES.LOGIN,\n      exact: true,\n      render: props => React.createElement(Login, Object.assign({}, props, {\n        handleLogin: this.handleLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      })),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: window.defConfigurations.url_prefix + ROUTES.RICERCA_CLIENTI,\n      exact: true,\n      render: props => React.createElement(RicercaClienti, Object.assign({}, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      })),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: window.defConfigurations.url_prefix + ROUTES.SUCCESS_EDIT,\n      exact: true,\n      render: props => React.createElement(SuccessEdit, Object.assign({}, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      })),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["C:\\Users\\Gigabyte\\Desktop\\react-bcc\\react-bcc\\bcc-anagrafiche-feature-only_login\\bcc-anagrafiche-ui\\src\\App.js"],"names":["React","Component","withRouter","Route","Switch","Login","RicercaClienti","SuccessEdit","USER_TYPE","ROUTES","axios","config","dotenv","App","state","userType","username","handleLogin","loginRequest","headers","conf","roles","post","apiLoginEndpoint","then","response","data","localStorage","setItem","accessToken","setState","length","authority","USER","ADMINISTRATOR","props","history","replace","window","defConfigurations","url_prefix","RICERCA_CLIENTI","IMPORTA_CLIENTI","catch","err","console","log","UNSAFE_componentWillMount","location","pathname","removeItem","LOGIN","api","REACT_APP_URL_JAVA","render","SUCCESS_EDIT"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './App.css';\r\nimport { withRouter, Route, Switch } from \"react-router-dom\";\r\nimport { Login } from \"./anagrafica_components/Login\";\r\nimport { RicercaClienti } from \"./anagrafica_components/RicercaClienti\";\r\nimport { SuccessEdit } from \"./anagrafica_components/SuccessEdit\";\r\n\r\nimport {USER_TYPE, ROUTES} from \"./anagrafica_components/common/Constants\";\r\nimport axios from \"axios\";\r\nimport config from \"./config.json\";\r\nimport dotenv from \"dotenv\";\r\n\r\ndotenv.config();\r\n\r\nclass App extends Component {\r\n  state = { \r\n    userType: null,\r\n    username: \"\"\r\n   }\r\n\r\n   UNSAFE_componentWillMount() {\r\n    //this if handle an eventual modification of URL from the user and redirect it to the login\r\n      if(this.props.location.pathname === \"/\" || this.props.location.pathname === \"\" || this.props.location.pathname === window.defConfigurations.url_prefix){\r\n        localStorage.removeItem(\"TOKEN\");\r\n        this.props.history.replace(window.defConfigurations.url_prefix + ROUTES.LOGIN);\r\n      }\r\n      \r\n      \r\n      \r\n     for (let api in config) {\r\n      config[api] = config[api].replace(\r\n        \"[REACT_APP_URL_JAVA]\",\r\n        window.defConfigurations.REACT_APP_URL_JAVA\r\n      );\r\n    }\r\n   }\r\n \r\n  handleLogin = (loginRequest) => {\r\n    const headers = { \"Content-Type\": \"application/json\"};\r\n    const conf = { headers: { ...headers } };\r\n\r\n    let roles = [];\r\n\r\n    axios.post(config.apiLoginEndpoint, loginRequest, conf)\r\n    .then(response => {\r\n        roles = [...response.data.roles];\r\n        //saving token and username in local storage to persist data for the session\r\n        localStorage.setItem(\"TOKEN\", response.data.accessToken);\r\n        localStorage.setItem(\"USERNAME\", response.data.username);\r\n\r\n        \r\n      \r\n        this.setState({roles: roles, username: response.data.username,\r\n          userType: roles.length === 1 && roles[0].authority === USER_TYPE.USER ? USER_TYPE.USER : USER_TYPE.ADMINISTRATOR})\r\n        //checking if the user logged is a simple user or an admin\r\n        if(roles.length === 1 && roles[0].authority === USER_TYPE.USER){\r\n          this.props.history.replace(window.defConfigurations.url_prefix + ROUTES.RICERCA_CLIENTI);\r\n        } else {\r\n          this.props.history.replace(window.defConfigurations.url_prefix + ROUTES.IMPORTA_CLIENTI);\r\n        }\r\n     }\r\n    )\r\n    .catch(err => console.log(err.response));\r\n  }\r\n\r\n \r\n  render() { \r\n   \r\n    return (\r\n      <div className=\"App\">\r\n         <Switch>\r\n              <Route\r\n                path={window.defConfigurations.url_prefix + ROUTES.LOGIN}\r\n                exact\r\n                render={(props) => <Login {...props} handleLogin={this.handleLogin}/>}\r\n              />\r\n               <Route\r\n                path={window.defConfigurations.url_prefix + ROUTES.RICERCA_CLIENTI}\r\n                exact\r\n            render={(props) => <RicercaClienti {...props} />}\r\n               />\r\n              <Route\r\n                path={window.defConfigurations.url_prefix + ROUTES.SUCCESS_EDIT}\r\n                exact\r\n                render={(props) => <SuccessEdit {...props}/>}\r\n              />\r\n        </Switch>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n \r\nexport default withRouter(App);\r\n"]},"metadata":{},"sourceType":"module"}